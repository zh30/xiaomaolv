[app]
bind = "0.0.0.0:8080"
default_provider = "minimax"
max_history = 20
concurrency_limit = 128

[providers.minimax]
kind = "openai-compatible"
base_url = "https://api.minimaxi.com/v1"
api_key = "${MINIMAX_API_KEY}"
model = "${MINIMAX_MODEL:-MiniMax-M2.5-highspeed}"
timeout_secs = 45
max_retries = 2

[channels.http]
enabled = true

# xiaomaolv-style default: polling mode, no public base URL required
[channels.telegram]
enabled = true
bot_token = "${TELEGRAM_BOT_TOKEN}"
bot_username = "${TELEGRAM_BOT_USERNAME:-}"
mode = "polling"
polling_timeout_secs = 30
streaming_enabled = true
streaming_edit_interval_ms = 900
streaming_prefer_draft = true
startup_online_enabled = true
startup_online_text = "${TELEGRAM_STARTUP_ONLINE_TEXT:-online}"
commands_enabled = true
commands_auto_register = true
commands_private_only = true
admin_user_ids = "${TELEGRAM_ADMIN_USER_IDS:-}"

# Optional webhook mode (public HTTPS required)
# mode = "webhook"
# webhook_secret = "${TELEGRAM_WEBHOOK_SECRET}"

[memory]
backend = "sqlite-only" # sqlite-only | hybrid-sqlite-zvec
max_recent_turns = 0 # 0 means fallback to app.max_history
max_semantic_memories = 8
semantic_lookback_days = 90

[memory.zvec]
endpoint = "${ZVEC_SIDECAR_ENDPOINT}"
collection = "agent_memory_v1"
query_topk = 20
request_timeout_secs = 3
upsert_path = "/v1/memory/upsert"
query_path = "/v1/memory/query"
# auth_bearer_token = "${ZVEC_SIDECAR_TOKEN}"

[agent]
mcp_enabled = true
mcp_max_iterations = 4
mcp_max_tool_result_chars = 4000
